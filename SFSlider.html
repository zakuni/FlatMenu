<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SFSlider</title> 
  </head> 
 
  <body>

    <form id="position"> 
      b <input type="text" value="" name="scrollB" />
    </form> 

    <form action="" method="" id="mouseposition"> 
      <ul> 
	<li>mousedownY: <input type="text" value="" name="mousedownY" /></li> 
	<li>mouseY: <input type="text" value="" name="onmouseY" /></li> 
	<li>scroll: <input type-"text" value="" name="scroll" /></li>
      </ul> 
    </form> 

    <iframe id="menu" src="menu.html" height="400" width=15% scrolling="no">
    </iframe>

    <iframe id="outline" src="outline.html" height="400" width=2% frameborder="0">
      iframe非対応
    </iframe>

    <iframe id="content" src="content.html" height="400"  width=80%>
      この部分は iframe 対応のブラウザで見てください。
    </iframe>



    <script>
      var click = 0;
      var scroll = 0;
      menu = window.frames[0];
      scrollbar = window.frames[1];
      content = window.frames[2];

      function getMousePosition(e) {      // マウスカーソル位置
        var mouse = new Object();      
          if(e) {
            mouse.y = e.pageY;
          }
        else {
          mouse.y = event.y + document.body.scrollTop;
        }      
        return mouse;
      }

      
      function setPosition() {
        target = document.getElementById('position');
      
        target.scrollY.value    = getScrollPosition().y;
        target.scrollB.value    = getScrollPosition().b;
      
        setTimeout( function(){setPosition()},50 );
      }


      function setMouseDownPosition(){  // クリック位置(スクロールスタート位置)
        mouseposition = document.getElementById('mouseposition');
      
        frames[1].onmousedown = function(e){
          mouseposition.mousedownY.value = getMousePosition(e).y;
          click = getMousePosition(e).y;
        }
      }      
      setMouseDownPosition();


      function setScroll(){
        mouseposition = document.getElementById('mouseposition');
        frames[1].onmousemove = function(e){
          mouseposition.onmouseY.value = getMousePosition(e).y;
          mouseposition.scroll.value = getMousePosition(e).y - click;
          scroll = getMousePosition(e).y - click;
          if(scroll < 0){
	    console.log("minus");
          }
        }
      }
      setScroll();
         

      function resetScroll(){
       frames[1].onmouseup = function(e){
          scroll = 0;
          console.log(scroll);
        }
        window.onmouseup = function(e){
          scroll = 0;
          console.log(scroll);
        }
      }
      resetScroll();

      function setPosition() {
        target = document.getElementById('position');
      
        target.scrollB.value    = getScrollPosition().b;
      
        setTimeout( function(){setPosition()},20 );
      }
      

      function getScrollPosition() { // スクロールバーの位置を取得(フレーム外とフレーム内)
        var obj = new Object();
      
        obj.b = frames[1].document.documentElement.scrollTop  || frames[1].document.body.scrollTop;
	window.frames[0].scrollTo(0, obj.b);
	if(obj.b == 0)
	  menu.location.replace("menu.html#a");  // 「あ」
	else if(obj.b == 964)
	  menu.location.replace("menu.html#wa"); // 「わ」
	else if(obj.b % 10 == 0){
          content.scrollTo(0, obj.b);
        }
        return obj;
      }
      
      setPosition();

    </script> 


  </body> 
</html> 
